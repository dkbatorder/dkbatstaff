<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DKBat Staff</title>

  <style>
    body {
      background-color: #f8fbff;
      color: #0a2540;
      font-family: "Poppins", Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    header {
      text-align: center;
      background: linear-gradient(135deg, #0066ff, #0044cc);
      color: #fff;
      padding: 18px 0;
      font-size: 1.6em;
      font-weight: 600;
      letter-spacing: 0.5px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    main {
      padding: 20px;
      max-width: 650px;
      margin: auto;
    }

    .booking {
      background: #fff;
      border-radius: 16px;
      padding: 16px 20px;
      margin-bottom: 16px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.05);
      border-left: 5px solid #0066ff;
      transition: transform 0.2s ease;
    }

    .booking:hover {
      transform: scale(1.01);
    }

    .booking strong {
      color: #003366;
    }

    #refreshBtn {
      display: block;
      background: #0066ff;
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 12px 20px;
      margin: 10px auto 25px auto;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.3s;
    }

    #refreshBtn:hover {
      background: #0044cc;
    }

    .empty {
      text-align: center;
      color: #777;
      margin-top: 30px;
    }

    footer {
      text-align: center;
      color: #666;
      font-size: 0.9em;
      padding: 20px;
    }
  </style>
</head>

<body>
  <header>DKBat Staff</header>
  <main>
    <button id="refreshBtn">üîÑ Refresh</button>
    <div id="bookings" class="empty">Loading latest bookings...</div>
  </main>
  <footer>¬© 2025 DKBat</footer>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
    import { getDatabase, ref, get, query, limitToLast, orderByKey } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDq6rMjZ0CeydCkWmQFLVmw6fes__Dy_RI",
      authDomain: "dkbat-orders.firebaseapp.com",
      databaseURL: "https://dkbat-orders-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "dkbat-orders",
      storageBucket: "dkbat-orders.firebasestorage.app",
      messagingSenderId: "208034554527",
      appId: "1:208034554527:web:97ce73e6f8cc786ae878aa",
      measurementId: "G-HHQ00E03VV"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    async function loadBookings() {
      const bookingsDiv = document.getElementById("bookings");
      bookingsDiv.innerHTML = "<p>Loading...</p>";

      try {
        const q = query(ref(db, "bookings"), orderByKey(), limitToLast(10));
        const snapshot = await get(q);
        const data = snapshot.val() || {};

        if (Object.keys(data).length === 0) {
          bookingsDiv.innerHTML = "<p class='empty'>No bookings yet.</p>";
          return;
        }

        const entries = Object.entries(data).reverse();
        bookingsDiv.innerHTML = "";

        for (const [id, booking] of entries) {
          const div = document.createElement("div");
          div.className = "booking";
          div.innerHTML = `
            <p><strong>üë§ Name:</strong> ${booking.name || "‚Äî"}</p>
            <p><strong>üíÜ Service:</strong> ${booking.service || "‚Äî"}</p>
            <p><strong>üìÖ Date:</strong> ${booking.date || "‚Äî"}</p>
            <p><strong>‚è∞ Time:</strong> ${booking.time || "‚Äî"}</p>
            <p><strong>üìã Status:</strong> ${booking.status || "Pending"}</p>
          `;
          bookingsDiv.appendChild(div);
        }
      } catch (err) {
        bookingsDiv.innerHTML = `<p class='empty'>Error loading bookings üòï<br>${err}</p>`;
      }
    }

    document.getElementById("refreshBtn").addEventListener("click", loadBookings);
    loadBookings();
  </script>
</body>
</html>
